# 两级页表

## [单级页表](./内存空间的分配与回收.md#内存空间的分配与回收##非连续分配管理###基本分页存储管理####数据结构)

### 存在的问题

1.  所有页表项必须连续存放，页表过大时需要很大的连续空间
2. 在一段时间内并非所有页面都用得到，因此没必要让整个页表常驻内存

## 两级页表

### 基本概念

将长页表进行分组，使得每个内存块（页框）刚好可以放入一个分组，然后为这些离散分配的页表再建立一张页表，成为页表目录（外层页表、顶层页表）

<img :src="$withBase='/img/os-tlpt.png'" class="align-center" />

### 实现地址转换

1. 按照地址结构将逻辑地址拆分成三部分
2. 从PCB中读出页目录表始址，再根据一级页号查页目录表，找到下一级页表在内存中的存放位置
3. 根据二级页号查表，找到最终想访问的内存块号
4. 结合页内偏移量得到物理地址

<img :src="$withBase='/img/os-two-level-page-table.png'" class="align-center" />

### 注意

1. 若采用多级页表机制，则各级页表的大小不能超过一个页面
2. 多级页表的访存次数（假设没有快表机构）---N级页表访问一个逻辑地址需要N+1次访存