# 流水线

## 客户端与服务器交互过程

1. 客户端向服务器发送命令请求
2. 服务器接受命令请求，并执行用户指定的命令调用，然后产生相应的命令执行结果
3. 服务器向客户端返回命令的执行结果
4. 客户端接收命令的执行结果，并向用户进行展示

与大多数网络程序一样，执行Redis命令所消耗的大部分时间都用在了发送命令和接收命令结果上，Redis服务器处理一个命令请求通常只需要很短的时间。所以，当程序执行的Redis命令越多，它需要进行的网络通信操作也会越多，程序的执行速度也会因此而变慢。



## 流水线

Redis提供了流水线特性：允许客户端把任意多条Redis命令请求打包在一起，然后一次性全部发给服务器，服务器会在流水线包含的所有命令请求都处理完毕后，一次性将它们的处理结果全部返回给客户端。

> 需要客户端也支持流水线特性

Redis服务器不会限制客户端在流水线中包含的命令数量，但是却会为客户端的输入缓冲区设置默认值为1GB的体积上限，当客户端发送的数据量超过这一限制时，Redis服务器将强制关闭该客户端。

许多客户端本身也带有隐含的缓冲区大小限制。

## 流水线与事务

流水线的作用是打包多个命令发送至服务器，事务的作用是打包多个命令让服务器一起执行它们。

## 使用注意

1. 流水线特性只是将多个命令一次性打包发给服务器，但是并不能保证服务器会将这些命令全都执行